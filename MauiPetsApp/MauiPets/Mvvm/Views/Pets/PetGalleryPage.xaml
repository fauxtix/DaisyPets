<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiPets.Mvvm.Views.Pets.PetGalleryPage"
             Title="Galeria de Fotos"
             x:Name="GalleryPage">
    <VerticalStackLayout Padding="18,12" Spacing="18">
        <Label Text="Galeria de Fotos" FontSize="28" FontAttributes="Bold" HorizontalOptions="Center"/>
        <Button Text="Adicionar Foto"
                Command="{Binding AddPhotoCommand}" />
        <CollectionView ItemsSource="{Binding Photos}" SelectionMode="None"
                        EmptyView="Sem fotos adicionadas ainda.">
            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" Span="3"/>
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="4" Margin="5" BackgroundColor="#fff" CornerRadius="18" 
                           HasShadow="True" BorderColor="#C5E1A5">
                        <Grid RowDefinitions="Auto, Auto" ColumnDefinitions="Auto, 60">
                            <Image Grid.Row="0" Grid.Column="0" 
                                   Source="{Binding PhotoPath}" Aspect="AspectFill" HeightRequest="120" WidthRequest="120">
                                <Image.GestureRecognizers>
                                    <TapGestureRecognizer 
                                            Command="{Binding Source={x:Reference GalleryPage}, Path=BindingContext.ShowPhotoCommand}" 
                                            CommandParameter="{Binding .}" />
                                </Image.GestureRecognizers>
                            </Image>
                            <Button Grid.Row="0" Grid.Column="1" Text="ðŸ—‘"
                                    Command="{Binding Source={x:Reference GalleryPage}, 
                                            Path=BindingContext.DeletePhotoCommand}"
                                    CommandParameter="{Binding .}"
                                    BackgroundColor="Transparent"
                                    HorizontalOptions="End" VerticalOptions="Start"
                                    WidthRequest="28" HeightRequest="28"/>
                            <Label Grid.Row="1" Grid.ColumnSpan="2" Text="{Binding DateAdded, StringFormat='Adicionada em: {0:dd/MM/yyyy}'}"
                                   FontSize="11" TextColor="Gray"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   Margin="0,6,0,0"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </VerticalStackLayout>
</ContentPage>